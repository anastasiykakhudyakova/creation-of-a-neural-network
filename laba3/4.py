#Обучение – это такая процедура, при которой мы так трансформируем параметры нейросети, что ошибка стремится к нулю.
#Градиентный спуск - это алгоритм оптимизации для нахождения минимума функции. 
#В машинном обучении он используется для минимизации функции ошибки (loss function) путем корректировки параметров модели.

#Измените начальное значение веса и входных данных. 
#Запустите код несколько раз с разными начальными значениями и выведите результаты. 
#Как начальные значения влияют на обучение нейросети?                  Большие веса - нестабильность. Маленькие веса - медленное обучение.

# Импорт библиотеки numpy для математических операций
import numpy as np
# Функция нейронной сети: простое умножение входа на вес
# inp - входное значение, weight - вес нейрона
def neural_networks(inp, weight):
    return inp * weight
  
# Функция вычисления ошибки: квадратичная ошибка (MSE)
# true_prediction - целевое значение, prediction - предсказание нейросети
def get_error(true_prediction, prediction):
    return (true_prediction - prediction) ** 2

# Функция градиентного спуска: обучает нейросеть за 10 итераций
# inp - входное значение, weight - начальный вес, true_prediction - целевое значение
def gradient(inp, weight, true_prediction):
    # Цикл на 10 итераций обучения
    for i in range(10): 
        # Вычисляем предсказание нейросети
        prediction = neural_networks(inp, weight)
        # Вычисляем ошибку предсказания
        error = get_error(true_prediction, prediction)
        # Выводим текущие значения с заданной точностью
        print("Prediction: %.10f, Weight: %.5f, Error: %.20f" %(prediction, weight, error))
        # Вычисляем градиент (производную ошибки по весу)
        # Формула: dE/dw = 2*(prediction - true_prediction)*inp, здесь опущен множитель 2
        delta = (prediction - true_prediction) * inp
        # Обновляем вес: gradient descent (w = w - α*gradient)
        # Здесь скорость обучения α = 1 (неявно)
        weight = weight - delta
true_prediction = 0.4 # Целевое значение, которое должна научиться предсказывать нейросеть

# Запуск 1: нормальные начальные значения (вход=0.9, вес=0.2)
print("Запуск 1: inp=0.9, weight=0.2")
gradient(0.9, 0.2, true_prediction)

print()

# Запуск 2: маленький вход и очень маленький начальный вес
print("Запуск 2: inp=0.2, weight=0.001")
gradient(0.2, 0.001, true_prediction)

print()

# Запуск 3: вход близкий к 1 и большой начальный вес
print("Запуск 3: inp=0.9999, weight=2")
gradient(0.9999, 2, true_prediction)

print()

# Запуск 4: вход близкий к 1 и очень большой начальный вес
print("Запуск 4: inp=0.9999, weight=20")
gradient(0.9999, 20, true_prediction)

print()

# Запуск 5: очень маленький вход и очень большой вес
print("Запуск 5: inp=0.00001, weight=200")
gradient(0.00001, 200, true_prediction)

print()

# Запуск 6: очень маленький вход и нормальный вес
print("Запуск 6: inp=0.00001, weight=0.2")
gradient(0.00001, 0.2, true_prediction)

