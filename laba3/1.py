#Оценка ошибки
#Предыдущиие работы реализовывали прямое распространение. Но с точки зрения нейросетей – это не очень интересно.
#Нейросеть подразумевает, что есть некоторый прогноз и при этом есть какой-то правильный ответ. 
#у нас есть какой-то входной набор данных, при этом мы знаем правильный ответ и знаем, что нам выдала нейросеть.Наша цель научиться понять насколько сильно она ошиблась.

#Напишите по памяти код из урока "Оценка ошибки".
# Импорт библиотеки numpy для работы с массивами и математическими операциями
import numpy as np

# Определение функции нейронной сети с простой архитектурой (один слой)
# inp - входной вектор данных (массив NumPy)
# weights - вектор весов (массив NumPy)
def neural_networks(inp, weights):
    # Выполнение скалярного произведения (dot product(скалярное произведение) — это математическая операция между двумя векторами, которая возвращает скаляр (одно число).) входных данных и весов
    # Это линейная комбинация: prediction = inp[0]*weights[0] + inp[1]*weights[1]
    return inp.dot(weights)

# Определение функции для расчета ошибки предсказания
# true_prediction - истинное (правильное) значение, которое должна была предсказать сеть
# prediction - фактическое предсказание, полученное от нейронной сети
def get_error(true_prediction, prediction):
    # Расчет среднеквадратичной ошибки для одного элемента
    # Квадрат разности между истинным значением и предсказанием
    # Квадрат используется для:
    # 1. Всегда положительного значения ошибки
    # 2. Усиления больших ошибок 
    # 3. Устранения знака разности
    return (true_prediction - prediction) ** 2
 
# Создание входного вектора с двумя признаками
inp = np.array([150, 40])

# Определение весовых коэффициентов для нейронной сети
weights = [0.2, 0.3]

# Выполнение предсказания нейронной сети
# prediction = 150*0.2 + 40*0.3 = 30 + 12 = 42
prediction = neural_networks(inp, weights)

# Вывод предсказания нейронной сети
print(prediction)  # вывод: 42.0

# Задание истинного (правильного) значения целевой переменной = 50
true_prediction = 50

# Вычисление и вывод простой разницы (ошибки без квадрата)
# Разность между истинным значением и предсказанием
# Это может быть положительным или отрицательным числом
print(true_prediction - prediction)  # 50 - 42 = 8

# Вычисление и вывод квадрата ошибки с помощью функции get_error()
# Используется среднеквадратичная ошибка: (50 - 42)^2 = 8^2 = 64
print(get_error(true_prediction, prediction))  # вывод: 64.0
