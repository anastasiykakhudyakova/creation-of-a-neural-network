#Замените списки с фиксированными весами на массивы numpy, 
#причём с генерацией случайных значений в них.

# Импорт библиотеки numpy для работы с массивами и математическими операциями
import numpy as np

# Определение функции нейронной сети, которая выполняет прямое распространение
# inp - входные данные, weights - список весовых матриц для каждого слоя
def neuralNetwork(inp, weights):
    # Умножение входных данных на веса первого скрытого слоя (матричное умножение)
    prediction_h1 = inp.dot(weights[0])
    # Умножение выхода первого скрытого слоя на веса второго скрытого слоя
    prediction_h2 = prediction_h1.dot(weights[1])
    # Умножение выхода второго скрытого слоя на веса выходного слоя
    prediction_out = prediction_h2.dot(weights[2])
    # Возврат конечного предсказания нейронной сети
    return prediction_out

# Функция для создания массива случайных чисел заданного размера
# size - размер создаваемого массива
def get_random_arr(size):
    # Генерация массива случайных чисел от 0 до 1 равномерного распределения
    return np.random.rand(size)

# Создание входного вектора с двумя признаками (например, возраст и вес)
inp = np.array([23, 45])

# Создание случайных весов для первого скрытого слоя (3 нейрона, каждый с 2 входами)
weight_h_1 = get_random_arr(2)  # Веса для первого нейрона скрытого слоя
weight_h_2 = get_random_arr(2)  # Веса для второго нейрона скрытого слоя
weight_h_3 = get_random_arr(2)  # Веса для третьего нейрона скрытого слоя

# Создание случайных весов для выходного слоя (3 нейрона, каждый с 2 входами)
weight_out_1 = get_random_arr(2)  # Веса для первого нейрона выходного слоя
weight_out_2 = get_random_arr(2)  # Веса для второго нейрона выходного слоя
weight_out_3 = get_random_arr(2)  # Веса для третьего нейрона выходного слоя

# Формирование матрицы весов для скрытого слоя размером 2x3
# .T - транспонирование для правильной ориентации матрицы
# (преобразуем из 3 строк по 2 элемента в 2 строки по 3 элемента)
weights_h = np.array([weight_h_1, weight_h_2, weight_h_3]).T

# Формирование матрицы весов для выходного слоя размером 2x3
weights_out = np.array([weight_out_1, weight_out_2, weight_out_3]).T

# Создание матрицы весов для первого слоя нейронной сети (2x2)
# Содержит веса первых двух нейронов скрытого слоя
weights_1 = np.array([weight_h_1, weight_h_2]).T

# Создание матрицы весов для второго слоя (2x2)
# Содержит веса третьего нейрона скрытого слоя и первого нейрона выходного слоя
weights_2 = np.array([weight_h_3, weight_out_1]).T

# Создание матрицы весов для третьего слоя (2x2)
# Содержит веса второго и третьего нейронов выходного слоя
weights_3 = np.array([weight_out_2, weight_out_3]).T

# Объединение всех весовых матриц в список для передачи в функцию нейронной сети
weights = [weights_1, weights_2, weights_3]

# Выполнение прямого распространения через нейронную сеть и вывод результата
print(neuralNetwork(inp, weights))
